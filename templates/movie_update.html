{% extends "base.html" %}
{% block title %}
    Update
{% endblock %}
{% block content %}
{% set runtime = movie.runtime.split() %}
{% set ratings = {
    "G": "(Genrel Audience)",
    "PG": "(Partenal Guidence)",
    "PG-13": "(Paternal guidence for under 13 year olds)",
    "R": "(Paternal guidence for under 17 year olds)",
    "NC-17": "(Viewers must be over 17)",
    "Unrated": "(No rating provided for this movie)"
    }
%}
<div class="row">
		<form id="update_form" action="{{url_for('insert_update', movie_id=movie._id)}}" method="POST" class="col s12">
			<div class="row">
				<div class="input-field col s12">
					<input id="movie_title" value="{{movie.title}}" name="title" type="text" class="validate" required>
					<label for="movie_title">Title</label>
				</div>
			</div>
            <div class="row">
				<div class="input-field col s12">
					<input id="tagline" name="tagline" value="{{movie.tagline}}" type="text" class="validate">
                    <label for="tagline">Tagline/Slogan (optional)</label>
				</div>
			</div>
            <div class="row">
				<div class="input-field col s12">
					<textarea id="movie_description" name="description" class="materialize-textarea" required>{{movie.description}}</textarea>
                    <label for="movie_description">Plot Synopsis</label>
				</div>
			</div>
            <div class="row">
				<div class="input-field col s4">
					<select id="movie_rating" name="rating" required class="validate">
                        <option value="" disabled>Select a rating</option>
                        {% for rating, description in ratings.items() %}
                            {% if movie.rating == rating %}
                                <option value="{{rating}}" selected>{{rating + " " + description}}</option>
                            {% else %}
                                <option value="{{rating}}">{{rating + " " + description}}</option>
                            {% endif %}
                        {% endfor %}
					</select>
                    <label for="movie_rating">Genres</label>
				</div>
				<div class="input-field col s4">
					<select id="movie_year" name="year" required>
				      {% for year in range(2021, 1909, -1) %}
                        {% if year == movie.year|int %}
                        <option value="{{year}}" selected>{{year}}</option>
                        {% else %}
                        <option value="{{year}}">{{year}}</option>
                        {% endif %}
                      {% endfor %}
				    </select>
					<label for="movie_year">Release Year</label>
				</div>
                <div class="input-field col s4">
					<input placeholder="1-100" id="movie_metascore" name="metascore" type="number" min="1" max="100" value="{{movie.metascore}}" class="validate" required>
					<label for="movie_metascore">Metascore</label>
				</div>
			</div>
            <div class="row">
                <h2 class="heading col s12 sml">Runtime (minutes)</h2>
				<div class="input-field col s12">
					<input type="range" id="runtime" name="runtime" min="1" max="250" value="{{runtime[0]}}" required>
				</div>
			</div>
			<div class="row">
				<div class="input-field col s12">
					<select id="movie_genres" name="genre" multiple required>
                        <option value="" disabled selected>Pick relevant genres</option>
				      {% for genre in genres %}
                        {% if genre._id in movie.genre%}
                        <option value="{{genre._id}}" selected>{{genre.genre_name}}</option>
                        {% else %}
                        <option value="{{genre._id}}">{{genre.genre_name}}</option>
                        {% endif %}
                      {% endfor %}
					</select>
                    <label for="movie_genres">Genres</label>
				</div>
			</div>
            <div class="row">
				<div class="input-field col s12">
                    <div id="movie_actors" class="row">
                        <div class="col s6">
					        <input name="actors[]" type="text" class="validate" value="{{movie.actors[0]}}" required>
					        <label for="actors[]">Actor(s)</label>
                        </div>
                        {% if movie.actors|length > 1 %}
                            {% for actor in movie.actors[1:] %}
                                <div class="col s6 actor-input">
                                    <input name="actors[]" type="text" value="{{actor}}" class="validate" required>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
				</div>
                <span id="actor_add" >Add</span>
                <span id="actor_remove" >Remove</span>
			</div>
            <div class="row">
				<div class="input-field col s12">
                    <div id="movie_directors" class="row">
                        <div class="col s6">
					        <input name="directors[]" type="text" value="{{movie.directors[0]}}" class="validate" required>
					        <label for="directors[]">Director(s)</label>
                        </div>
                        {% if movie.directors|length > 1 %}
                            {% for director in movie.directors[1:] %}
                                <div class="col s6 director-input">
                                    <input name="director[]" type="text" value="{{director}}" class="validate" required>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
				</div>
                <span id="director_add" >Add</span>
                <span id="director_remove" >Remove</span>
			</div>
            <div class="row">
				<div class="input-field col s12">
                    <div id="movie_languages" class="row">
                        <div class="col s6">
					        <input name="languages[]" type="text" class="validate" placeholder="English" value="{{movie.languages[0]}}" required>
					        <label for="languages[]">Languages(s)</label>
                        </div>
                        {% if movie.languages|length > 1 %}
                            {% for language in movie.languages[1:] %}
                                <div class="col s6 language-input">
                                    <input name="languages[]" type="text" value="{{language}}" class="validate" required>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
				</div>
                <span id="language_add" >Add</span>
                <span id="language_remove" >Remove</span>
			</div>
            <div class="row">
				<div class="input-field col s12">
					<input id="movie_img_url" placeholder="(i.e.) https://images-na.ssl-images-amazon.com/images/I/31dKO0hfksL._AC_.jpg"  value="{{movie.img_url}}" name="img_url" type="text" class="validate">
					<label for="movie_img_url">Poster URL (optional)</label>
				</div>
			</div>
            <div class="row">
				<div class="input-field col s12">
					<input id="movie_imdb_url" placeholder="(i.e.) https://www.imdb.com/title/tt0078748/" value="{{movie.imdb_url}}" name="imdb_url" type="text" class="validate">
					<label for="movie_imdb_url">Link to IMDB page (optional)</label>
				</div>
			</div>
			<div class="row">
                <div class="col s12">
				    <button class="btn waves-effect waves-light left" type="submit">Update</button>
                    <a class="btn waves-effect waves-light right" href="{{url_for('browse_movies')}}">Cancel</a>
                </div>
			</div>
		</form>
	</div>

{% endblock %}